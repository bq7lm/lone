{% extends "base.html" %}
{% block main_content %}

<div class="account-container" style="max-width: 600px; margin: 0 auto; padding: 20px; color: white;">

    <!-- Заголовок -->
    <h2 class="section-title" style="margin-bottom: 20px;">Настройки аккаунта</h2>

    <!-- Текущая аватарка и кнопка изменить -->
    <div class="current-avatar" style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
        <img src="{{ url_for('static', filename='avatars/' + selected_avatar) }}" alt="Аватар" id="current-avatar" style="width:100px; height:100px; border-radius:50%; border:2px solid red; object-fit:cover;">
        <button id="change-avatar-btn" type="button" style="background:red; padding: 10px 16px; border-radius:8px; font-weight:bold; cursor:pointer;">Изменить аватар</button>
    </div>

    <!-- Скрытое меню выбора аватарок -->
    <form method="POST" class="avatar-form" id="avatar-menu" style="display: none; margin-bottom: 30px;">
        <h3 style="margin-bottom: 15px;">Выберите аватар</h3>
        <div class="avatar-list" style="display:flex; flex-wrap:wrap; gap:15px;">
            {% for avatar in avatars %}
            <label class="avatar-item" style="cursor:pointer; display:flex; flex-direction:column; align-items:center;">
                <input type="radio" name="avatar" value="{{ avatar }}" style="display:none;" {% if avatar == selected_avatar %}checked{% endif %}>
                <img src="{{ url_for('static', filename='avatars/' + avatar) }}" alt="{{ avatar }}" style="border-radius:50%; width:80px; height:80px; border:2px solid transparent; transition: transform 0.2s;">
            </label>
            {% endfor %}
        </div>
        <button type="submit" style="margin-top:20px; background:red; border:none; border-radius:8px; padding:10px 16px; font-weight:bold; color:white;">Сохранить выбор</button>
    </form>

</div>

<script>
    const changeBtn = document.getElementById('change-avatar-btn');
    const avatarMenu = document.getElementById('avatar-menu');

    changeBtn.addEventListener('click', () => {
        if(avatarMenu.style.display === 'none') {
            avatarMenu.style.display = 'block';
            changeBtn.textContent = 'Скрыть выбор аватарок';
        } else {
            avatarMenu.style.display = 'none';
            changeBtn.textContent = 'Изменить аватар';
        }
    });

    // Подсветка выбранного аватара
    const avatarItems = avatarMenu.querySelectorAll('.avatar-item input');
    avatarItems.forEach(input => {
        input.addEventListener('change', () => {
            avatarItems.forEach(i => i.nextElementSibling.style.borderColor = 'transparent');
            input.nextElementSibling.style.borderColor = 'red';
            document.getElementById('current-avatar').src = input.nextElementSibling.src;
        });
    });
</script>

{% endblock %}
